# Convey MVP
작성자: 염수경


## 전제
클라이언트 구현의 복잡성을 낮추기 위해 전체 질문유형에 대해 단일 스키마를 사용한다는 전제입니다.   
생성-제출-매칭 전체 플로우에 대한 클라이언트 입장의 브레인스토밍이며,   
당연히 모든 부분을 고려하진 못했으니 조감도 그리는 정도로 참고해주시고 추가 논의가 필요합니다.


## 핵심 로직 정리
1. 독립적인 소주제를 생성한다.
2. 해당 소주제를 특정 설문, 특정 디바이더의 **대주제 하위**에 붙일 수 있다.
3. 소주제 생성 및 수정 시 각 질문의 ID는 항상 새로이 발행된 고유한 ID로 갈음되어야 한다. (소주제ID는 유지)
5. 티켓 발행 시점부터 대주제에 붙인 소주제들은 모두 수정이 불가하다.


## 1. 소주제 생성 및 수정 (웹)
소주제는 다수의 섹터를, 섹터는 다수의 질문을 포함한다.  
항상 소주제 단위로 덤프하여 Mutate한다.  
이때마다, 소주제에 포함된 질문들은 항상 새로운 고유ID를 가져야 한다.


## 2. 답변 제출 (앱)
기본적으로 설문ID, 피험자ID를 제출하여야 한다.  
답변을 제출할 때는 항상 질문ID와 함께 제출하여야 한다.


## 3. 질답 매칭 (웹)
설문ID를 사용하여 설문 - 디바이더 - 대주제 - 소주제 정보를 불러온 후,  
질문ID를 사용하여 질문과 답변을 매칭한다.


## 소주제 POST 스키마
```
{
  소주제제목: string
  소주제설명: string | null
  섹터들: [{
    질문유형: string,
    섹터설명: string | null
    공통응답기준: [string] | null
    질문들: [{
      질문이름: string,
      선지: [{
        선지이름: string | null,
        서술여부: boolean,
        서술형식: string | null
      }] | null,
      단일서술형식: string | null
    }] 
  }]
}
```


## 섹터 세부 스키마 - 리커트척도 예시
공통응답기준의 개수대로 앱측에서 선지 자동 생성.  
예시) ①②③④⑤⑥⑦⑧
```
{
  질문유형: 리커트척도
  섹터설명: 다음 교과의 학교수업 시간에 수업내용을 어느정도 이해하고 있다고 생각하십니까?
  공통응답기준: [전혀이해못함, 대부분이해못함, 보통, 대부분이해함, 모두이해함]
  질문들: [
    {
      질문이름: 국어,
      선지: null,
      단일서술형식: null
    },
    {
      질문이름: 수학,
      선지: null,
      단일서술형식: null
    },
    {
      질문이름: 영어,
      선지: null,
      단일서술형식: null
    }
  ]
}
```


## 섹터 세부 스키마 - 단일선택(가부) 예시
공통응답기준의 개수대로 앱측에서 선지 자동 생성.  
예시) ①②
```
{
  질문유형: 단일가부선택
  섹터설명: null
  공통응답기준: [네, 아니오]
  질문들: [
    {
      질문이름: 지난 1년간 학교 이외에 사교육을 받은 경험이 있습니까?,
      선지: null,
      단일서술형식: null
    }
  ]
}
```


## 섹터 세부 스키마 - 단일선택(다수) 예시
선지별 서술여부가 true라면 서술형식을 사용하여 앱측에서 폼 생성.
```
{
  질문유형: 단일다수선택
  섹터설명: null
  공통응답기준: null
  질문들: [
    {
      질문이름: 관심이나 흥미가 가는 주제가 있을 때 가장 많이 이용하는 검색경로는 무엇인가요?
      선지: [
        {
          선지이름: 온라인 동영상 플랫폼(유튜브, 아프리카 TV, 트위치 등),
          서술여부: false,
          서술형식: null
        },
        {
          선지이름: SNS(페이스북, 인스타그램, 트위터 등),
          서술여부: false,
          서술형식: null
        },
        {
          선지이름: 기타
          서술여부: true,
          서술형식: '{{__}}'
        }
      ],
      단일서술형식: null
    },
    {
      질문이름: 지난 7일간, 한번에 적어도 10분 이상 걸은 날이 며칠입니까?
      선지: [
        {
          선지이름: null,
          서술여부: true,
          서술형식: '일주일에 {{__}}일'
        },
        {
          선지이름: 걷지 않았음,
          서술여부: false,
          서술형식: null
        }
      ],
      단일서술형식: null
    }
  ]
}
```


## 섹터 세부 스키마 - 복수선택 예시
```
{
  질문유형: 복수선택
  섹터설명: null
  공통응답기준: null
  질문들: [
    {
      질문이름: 지난 1주일 동안 컴퓨터/스마트기기로 인터넷을 이용했다면 어떤 기기로 이용했나요?
      선지: [
        {
          선지이름: 컴퓨터,
          서술여부: false,
          서술형식: null
        },
        {
          선지이름: 스마트기기(스마트폰 혹은 태블릿 PC),
          서술여부: false,
          서술형식: null
        },
        {
          선지이름: 모두 이용하지 않았다
          서술여부: false,
          서술형식: null
        }
      ],
      단일서술형식: null
    }
  ]
}
```


## 섹터 세부 스키마 - 숫자단답형 예시
단일서술형식을 사용하여 앱측에서 폼 생성.  
폼에는 숫자만 입력 가능.
```
{
  질문유형: 숫자단답형
  섹터설명: 현재 학원이나 과외, 방문학습을 일주일에 몇 시간을 받나요?
  공통응답기준: null
  질문들: [
    {
      질문이름: 국어,
      선지: null,
      단일서술형식: '{{__}} 시간'
    },
    {
      질문이름: 수학,
      선지: null,
      단일서술형식: '{{__}} 시간'
    },
    {
      질문이름: 영어,
      선지: null,
      단일서술형식: '{{__}} 시간'
    }
  ]
}
```


## 섹터 세부 스키마 - 문자단답형 예시
문자단답형과 문자장문형 차이 없음.  
단일서술형식을 사용하여 앱측에서 폼 생성.  
폼에는 문자만 입력 가능.
```
{
  질문유형: 문자단답형
  섹터설명: null
  공통응답기준: null
  질문들: [
    {
      질문이름: 학생의 이름을 기입해 주세요,
      선지: null,
      단일서술형식: '본인 이름 : {{__}}'
    },
    {
      질문이름: 학생의 학교명과 반을 기입해 주세요,
      선지: null,
      단일서술형식: '{{__}}학교 {{__}}반'
    }
  ]
}
```


## 답변 스키마 - 공통 예시
```
{
  설문ID: number,
  피험자ID: number,
  답변들: [
    {
      질문ID: number
      선택한선지: [{
        선지이름: string,
        서술답변: string | null
      }] | null,
      단일서술답변: string | null
    }
  ]
}
```
